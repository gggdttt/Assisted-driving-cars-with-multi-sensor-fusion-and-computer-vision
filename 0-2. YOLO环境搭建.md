# 0-2.Win10 + VS2019 配置Darknet YOLOv3



> Reference：https://pjreddie.com/darknet/yolo/
>
> 这个链接是YOLO的官方网站。
>
> 想要了解更多YOLO3更新的内容的同学，可以点击https://pjreddie.com/darknet/yolo/ 下载paper阅读。

其实YOLO团队已经训练完成了很多内容，我们只需要下载就能将其应用到我们的程序中。



- CPU: i7-8565u（别吐槽我用的轻薄本=-=）
- GPU: GeForce MX150（同上）
- OS: Windows 10 家庭中文版 64bit
- CUDA: 10.2
- CUDNN: 7.6.4
- OpenCV: 3.2

> 此处默认读者已部署上述环境,值得一提的是如果读者有**部署GPU版本**的需求的话,切记前往NVIDIA官网查看驱动版本是否需要更新,否则容易遇到GPU版无法正常运行的问题,**永远不要相信第三方检测工具告诉你的数据**,笔者为此浪费近两个小时时间 = =
>
> 另外希望读者注意安装VS2017 / VS2019时特别注意勾选MSVC v140组件，且安装VS后再安装CUDA及CUDNN
>
> CUDA和CUDNN完整的安装过程可以参考：https://blog.csdn.net/c20081052/article/details/86683446
>
> 全部过程也可以参考：https://blog.csdn.net/StrongerL/article/details/81007766

# Step 1

前往[Darknet YOLOv3](https://github.com/alexeyab/darknet)下载项目或`git clone https://github.com/alexeyab/darknet.git`

# Step 2

.\darknet\build\darknet目录下用sublime或记事本打开darknet.vcxproj,将2个CUDA 10.0替换为自己的CUDA版本号，例如本人使用CUDA 10.2,则替换为CUDA 10.2即可。

> 在部分比较老的文章中，这里默认的版本号是`9.1`,推荐大家直接在文本中搜索`CUDA`

# Step 3

打开darknet.sln,应该会弹出如下图所示界面，如果没有就在选项卡中 项目–重定向打开，特别注意平台工具集选择无升级，另外我自己测试Windows SDK版本有10.0最新的选项，但是选了编译会有报错，**猜想应该要选具体版本合适些**。
[![KkePSJ.png](https://s2.ax1x.com/2019/10/16/KkePSJ.png)](https://imgchr.com/i/KkePSJ)
同时打开选项卡 调试–darknet属性修改项目属性。
配置属性–VC++目录–包含目录–编辑
填入(.为读者opencv路径)
`.\opencv\bulid\include`
`.\opencv\bulid\include\opencv`
`.\opencv\bulid\include\opencv2`
[![KkdWCQ.png](https://s2.ax1x.com/2019/10/17/KkdWCQ.png)](https://imgchr.com/i/KkdWCQ)
配置属性–VC++目录–库目录–编辑
填入`.\opencv\bulid\x64\vc14\lib`
![Kkdj29.png](https://s2.ax1x.com/2019/10/17/Kkdj29.png)
链接器–输入–附加依赖项
加入`.\opencv\build\x64\vc14\lib`下读者的库名字（根据opencv版本变化会有不同）
![Kkwi5D.png](https://s2.ax1x.com/2019/10/17/Kkwi5D.png)

# Step 4

将`.\opencv\build\x64\vc14\bin`下的opencv_world330.dll 和opencv_ffmpeg330_64.dll 复制到 `.\darknet\darknet-master\build\darknet\x64`目录下。
检查项目属性为Release x64后，右键项目重新生成即可。若严格按照本文步骤应该不会出现报错。如有报错请评论/或邮件cheerway.liu@gmail.com
[![KkwQIS.png](https://s2.ax1x.com/2019/10/17/KkwQIS.png)](https://imgchr.com/i/KkwQIS)

# Step 5

前往[Darknet Github](https://github.com/AlexeyAB/darknet/blob/master/README.md)下载训练好的模型进行测试，如下图所示，根据自己需求。
[![KkwfIO.png](https://s2.ax1x.com/2019/10/17/KkwfIO.png)](https://imgchr.com/i/KkwfIO)
以yolov3.weights为例，

进到对应目录下的cmd命令行，输入：

```shell
darknet detect cfg/yolov3.cfg yolov3.weights data/bird.jpg
#darknet [detect] [选用哪个cfg文件][选用哪个对应的weights] [识别哪张图片] 
```





